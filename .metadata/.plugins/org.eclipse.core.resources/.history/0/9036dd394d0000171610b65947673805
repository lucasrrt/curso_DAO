package curso_DAO;

import java.sql.*;
import java.util.ArrayList;

public class DAO {
	protected String TABLE_NAME;
	public DAO(String ...strings){
		
	}
	public boolean create(String ... strings){
		return false;
	}
	public ArrayList<DAO> retrieveAll(){
		try{
		ResultSet resultset = query("select * from "+ TABLE_NAME);
		ArrayList<DAO> DAOlist = new ArrayList<DAO>(); 
		while (resultset.next()) {              
		        int i = 1;
		        ArrayList<String> values = new ArrayList<String>();
		        while(i <= (resultset.getMetaData()).getColumnCount()) {
		            values.add(resultset.getString(i++));
		        }
		        DAOlist.add(new DAO((String [])values.toArray()));
		        System.out.println(resultset.getString("Col 1"));
		        System.out.println(resultset.getString("Col 2"));
		        System.out.println(resultset.getString("Col 3"));                    
		        System.out.println(resultset.getString("Col n"));
		}
		return DAOlist;
		}catch(Exception e){
			e.printStackTrace();
			return null;
		}
	}
	public boolean update(){
		return false;
	}
	public boolean delete(){
		return false;
	}
	private static ResultSet query(String sql){
		Connection connection = null;
		Statement statement = null;
		try {
			Class.forName("org.postgresql.Driver");

			connection = DriverManager.getConnection("jdbc:postgresql://127.0.0.1:5432/curso_DAO","postgres","postgres");
			statement = connection.createStatement();
			ResultSet resultSet = statement.executeQuery(sql);

			//statement.close();
			//connection.close();

			return resultSet;
		} catch (Exception e) {
			System.out.println("Connection Failed! Check output console");
			e.printStackTrace();
			return null;
		}
	}
}
